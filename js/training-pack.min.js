angular.module("ngLocale",[],["$provide",function(b){var c={ZERO:"zero",ONE:"one",TWO:"two",FEW:"few",MANY:"many",OTHER:"other"};b.value("$locale",{DATETIME_FORMATS:{MONTH:["Januar","Februar","März","April","Mai","Juni","Juli","August","September","Oktober","November","Dezember"],SHORTMONTH:["Jan","Feb","Mär","Apr","Mai","Jun","Jul","Aug","Sep","Okt","Nov","Dez"],DAY:["Sonntag","Montag","Dienstag","Mittwoch","Donnerstag","Freitag","Samstag"],SHORTDAY:["So.","Mo.","Di.","Mi.","Do.","Fr.","Sa."],AMPMS:["vorm.","nachm."],medium:"dd.MM.yyyy HH:mm:ss","short":"dd.MM.yy HH:mm",fullDate:"EEEE, d. MMMM y",longDate:"d. MMMM y",mediumDate:"dd.MM.yyyy",shortDate:"dd.MM.yy",mediumTime:"HH:mm:ss",shortTime:"HH:mm"},NUMBER_FORMATS:{DECIMAL_SEP:",",GROUP_SEP:".",PATTERNS:[{minInt:1,minFrac:0,macFrac:0,posPre:"",posSuf:"",negPre:"-",negSuf:"",gSize:3,lgSize:3,maxFrac:3},{minInt:1,minFrac:2,macFrac:0,posPre:"",posSuf:" \u00A4",negPre:"-",negSuf:" \u00A4",gSize:3,lgSize:3,maxFrac:2}],CURRENCY_SYM:"€"},pluralCat:function(e){if(e==1){return c.ONE}return c.OTHER},id:"de"})}]);(function(f){f.timeago=function(i){if(i instanceof Date){return b(i)}else{if(typeof i==="string"){return b(f.timeago.parse(i))}else{if(typeof i==="number"){return b(new Date(i))}else{return b(f.timeago.datetime(i))}}}};var h=f.timeago;f.extend(f.timeago,{settings:{refreshMillis:60000,allowFuture:false,strings:{prefixAgo:null,prefixFromNow:null,suffixAgo:"ago",suffixFromNow:"from now",seconds:"less than a minute",minute:"about a minute",minutes:"%d minutes",hour:"about an hour",hours:"about %d hours",day:"a day",days:"%d days",month:"about a month",months:"%d months",year:"about a year",years:"%d years",wordSeparator:" ",numbers:[]}},inWords:function(o){var p=this.settings.strings;var l=p.prefixAgo;var u=p.suffixAgo;if(this.settings.allowFuture){if(o<0){l=p.prefixFromNow;u=p.suffixFromNow}}var r=Math.abs(o)/1000;var i=r/60;var q=i/60;var s=q/24;var m=s/365;function k(v,x){var w=f.isFunction(v)?v(x,o):v;var y=(p.numbers&&p.numbers[x])||x;return w.replace(/%d/i,y)}var n=r<45&&k(p.seconds,Math.round(r))||r<90&&k(p.minute,1)||i<45&&k(p.minutes,Math.round(i))||i<90&&k(p.hour,1)||q<24&&k(p.hours,Math.round(q))||q<42&&k(p.day,1)||s<30&&k(p.days,Math.round(s))||s<45&&k(p.month,1)||s<365&&k(p.months,Math.round(s/30))||m<1.5&&k(p.year,1)||k(p.years,Math.round(m));var j=p.wordSeparator===undefined?" ":p.wordSeparator;return f.trim([l,n,u].join(j))},parse:function(j){var i=f.trim(j);i=i.replace(/\.\d+/,"");i=i.replace(/-/,"/").replace(/-/,"/");i=i.replace(/T/," ").replace(/Z/," UTC");i=i.replace(/([\+\-]\d\d)\:?(\d\d)/," $1$2");return new Date(i)},datetime:function(j){var i=h.isTime(j)?f(j).attr("datetime"):f(j).attr("title");return h.parse(i)},isTime:function(i){return f(i).get(0).tagName.toLowerCase()==="time"}});f.fn.timeago=function(){var j=this;j.each(e);var i=h.settings;if(i.refreshMillis>0){setInterval(function(){j.each(e)},i.refreshMillis)}return j};function e(){var i=c(this);if(!isNaN(i.datetime)){f(this).text(b(i.datetime))}return this}function c(i){i=f(i);if(!i.data("timeago")){i.data("timeago",{datetime:h.datetime(i)});var j=f.trim(i.text());if(j.length>0&&!(h.isTime(i)&&i.attr("title"))){i.attr("title",j)}}return i.data("timeago")}function b(i){return h.inWords(g(i))}function g(i){return(new Date().getTime()-i.getTime())}document.createElement("abbr");document.createElement("time")}(jQuery));jQuery.timeago.settings.strings={prefixAgo:"vor",prefixFromNow:"in",suffixAgo:"",suffixFromNow:"",seconds:"wenigen Sekunden",minute:"etwa einer Minute",minutes:"%d Minuten",hour:"etwa einer Stunde",hours:"%d Stunden",day:"etwa einem Tag",days:"%d Tagen",month:"etwa einem Monat",months:"%d Monaten",year:"etwa einem Jahr",years:"%d Jahren"};angular.module("pdate",[]).filter("pdate",function(){return function(b,c){if(b){a=b.split(" ");d=a[0].split("-");t=a[1].split(":");return new Date(d[0],(d[1]-1),d[2],t[0],t[1],t[2])}}});angular.module("timeago",[]).filter("timeago",function(){return function(b,c){return $.timeago(b)}});angular.module("addButton",[]).directive("addButton",function(b){return function(f,e,c){if(c.addButton.length>0){caption=c.addButton}else{caption="Add"}if(c.addButtonAction&&c.addButtonAction.length>0){action=c.addButtonAction}else{action="showDlg()"}butAdd=$("<button ng-click='"+action+"'>"+caption+"</button>").button({icons:{primary:"ui-icon-plusthick"}});butAdd.css("float","right");cbut=b(butAdd)(f);$(function(){child=e.parent().find(".dataTables_filter");$(child).append(cbut)})}});angular.module("jqAutoComplete",[]).directive("jqAutoComplete",function(){return{require:"?ngModel",link:function(f,e,c,b){$(e).autocomplete();if(c.ngModel){e.blur(function(){return f.$apply(function(){b.$setViewValue(e.val())})})}f.$watch(c.jqAutoComplete,function(g){var h=g||null;if(h){$(e).autocomplete("option","source",f.$eval(c.jqAutoComplete))}})}}});angular.module("myTable",[]).directive("myTable",function(){return function(g,e,c){var b={};if(c.myTable.length>0){b=g.$eval(c.myTable)}else{b={bStateSave:false,iCookieDuration:2419200,bJQueryUI:true,bPaginate:false,bLengthChange:false,bFilter:true,bInfo:true,bDestroy:true,bDeferRender:true,bProcessing:true}}var f=[];e.find("th").each(function(i,j){f.push($(j).text())});if(f.length>0){b.aoColumns=f}else{if(c.aoColumns){b.aoColumns=g.$eval(c.aoColumns)}}if(c.aoColumnDefs){b.aoColumnDefs=g.$eval(c.aoColumnDefs)}if(c.fnRowCallback){b.fnRowCallback=g.$eval(c.fnRowCallback)}var h=e.dataTable(b);g.$watch(c.aaData,function(i){var j=i||null;if(j){h.fnClearTable();h.fnAddData(g.$eval(c.aaData))}})}});angular.module("jqDialog",[]).directive("jqDialog",function(){return{link:function(e,c,b){if(b.jqDialog.length>0){options=e.$eval(b.jqDialog)}else{options={modal:true}}options.autoOpen=false;options.close=function(){e.dlgState=false;e.$digest()};if(b.dlgButtons&&b.dlgButtons.length>0){options.buttons=e.$eval(b.dlgButtons)}else{options.buttons={Cancel:options.close,Save:function(){if(b.dlgAction){e.$eval(b.dlgAction)()}else{e.submitDlg()}}}}e.openDlg=function(){c.dialog("open")};e.$watch("dlgState",function(g,f){console.log("dialog status was "+f+" is now "+g);if(g){c.dialog("open")}else{c.dialog("close")}});$(c).dialog(options);e.dlgState=false}}});angular.module("jqButton",[]).directive("jqButton",["$compile",function(b){return function(f,e,c){butOptions={};if(c.jqButton.length>0){butOptions.icons={primary:"ui-icon-"+c.jqButton}}e.button(butOptions)}}]);angular.module("trainSite",["pdate","timeago","jqDialog","ngCookies","jqAutoComplete","jqButton"]);var TrainCtrl=function(c,i,e,h){function f(){console.log("Adding Comment "+c.curCmt.msg+" from "+c.curCmt.usr);i.post("/res/trainings/"+tid+"/comments",c.curCmt).error(function(j){console.log("Fehler: "+j)}).success(function(j){console.log("OK!");c.comments.unshift(j)})}function g(){if(!c.nameKnown()){return false}myVote=$.grep(c.votes,function(j){return j.name==e.user});if(myVote.length>0){console.dir(myVote[0]);c.curVote=myVote[0];return true}else{return false}}c.nameKnown=function(){return !(c.usrname==""||!c.usrname)};c.revote=function(){console.log("revoting to "+c.curVote.vid);console.log("Usr is |"+c.curVote.name+"| -> empty:"+(c.curVote.name==""||!c.curVote.name));if(!c.curVote.name||c.curVote.name==""){h.alert("Bitte erst Namen eingeben!")}else{c.usrname=c.curVote.name;i.post("/res/trainings/"+tid+"/votes",c.curVote).error(function(j){console.log("Fehler: "+j)}).success(function(j){console.log("OK!");b()})}};function b(){nocache=Math.random();i.get("/res/trainings/"+tid+"/votes?nocache="+nocache).success(function(j){c.votes=j;c.voted=g()})}$.ajaxSetup({cache:false});c.usrname=e.user||"";c.curVote={tid:tid,name:e.user,vid:0,vote:""};c.curCmt={msg:"",autor:e.user,tid:tid};i.get("/res/votetypes").success(function(j){c.votetypes=j});i.get("/res/trainings/"+tid+"/comments").success(function(j){c.comments=j});i.get("/res/trainings/"+tid+"/stats").success(function(j){c.stats=j});i.get("/res/users").success(function(j){c.unames=j});i.get("/res/trainings/"+tid+"/details").success(function(j){c.details=j});b();c.dlgState=false;c.submitDlg=function(){f();c.dlgState=false}};TrainCtrl.$inject=["$scope","$http","$cookies","$window"];