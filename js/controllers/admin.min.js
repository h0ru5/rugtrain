angular.module("adminPanel",["myTable","ngResource","jqDialog","addButton"]);function actButtons(a){this.aTargets=[-1];this.mData=a;this.fnCreatedCell=function(c,b,f,e,d){butDel=$("<button>delete</button>").button({text:false,icons:{primary:"ui-icon-trash"}}).on("click",function(){myscope=angular.element(c).scope().doDel(f)});butEdit=$("<button>edit</button>").button({text:false,icons:{primary:"ui-icon-wrench"}}).on("click",function(){myscope=angular.element(c).scope().doEdit(f)});$(c).empty().prepend(butDel).prepend(butEdit)}}function userAdmin(a,c,b){var d=b("/admin/users/:userId",{userId:"@id"});a.userColumnDefs=[{mData:"name",aTargets:[0]},{mData:"email",aTargets:[1]},new actButtons("id")];a.showDlg=function(){a.curUsr=new d();a.dlgState=true};a.hideDlg=function(){a.dlgState=false;a.$digest()};a.refresh=function(){d.query(function(e){a.users=e})};a.doDel=function(e){if(c.confirm(e.name+" wirklich löschen?")){d.remove({userId:e.id})}a.refresh()};a.doEdit=function(e){a.curUsr=d.get({userId:e.id});a.dlgState=true};a.submitDialog=function(){a.curUsr.$save();a.dlgState=false;a.refresh()};a.dlgState=false;a.refresh();a.curUsr=new d()}function eventAdmin(b,d,e){b.eventColumnDefs=[{mDataProp:"what",aTargets:[0]},{mDataProp:"where",aTargets:[1]},{mDataProp:"when",aTargets:[2]},new actButtons("tid")];var a=d("/admin/trainings/:evtId",{evtId:"@tid"});function c(){a.query(function(f){b.events=f})}b.doDel=function(f){if(e.confirm(f.what+" ("+f.where+") wirklich löschen?")){a.remove({evtId:f.tid})}c()};b.doEdit=function(f){b.curEvt=a.get({evtId:f.tid});b.dlgState=true};b.showDlg=function(){b.curEvt=new a();b.dlgState=true};b.submitDlg=function(){b.curEvt.$save();b.dlgState=false;c()};b.dlgState=false;c();b.curEvt=new a()}function commentAdmin(a,c,e){a.commentColumnDefs=[{mDataProp:"tid",aTargets:[0]},{mDataProp:"autor",aTargets:[1]},{mDataProp:"time",aTargets:[2]},{mDataProp:"msg",aTargets:[3]},new actButtons("id")];var d=c("/admin/comments/:cmtId",{cmtId:"@id"});function b(){d.query(function(f){a.comments=f})}a.doDel=function(f){if(e.confirm("Kommentar wirklich löschen?")){d.remove({cmtId:f.id})}b()};a.doEdit=function(f){a.curCmt=d.get({cmtId:f.id});a.dlgState=true};a.submitDlg=function(){a.curCmt.$save();a.dlgState=false;b()};a.dlgState=false;b();a.curCmt=new d()};